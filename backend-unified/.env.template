# ZIENSHIELD BACKEND UNIFICADO - TEMPLATE DE VARIABLES DE ENTORNO
# =================================================================
# Copia este archivo a .env y ajusta los valores según tu entorno

# ENTORNO DE EJECUCIÓN
# ====================
NODE_ENV=development
# Opciones: development, production, test

# CONFIGURACIÓN DEL SERVIDOR
# ==========================
PORT=3001
HOST=0.0.0.0
BASE_URL=http://localhost:3001
# En producción, usa tu dominio real: https://api.tudominio.com

# CONFIGURACIÓN DE BASE DE DATOS
# ==============================
DB_HOST=localhost
DB_PORT=5432
DB_NAME=zienshield
DB_USER=postgres
DB_PASSWORD=secure_password_here
DB_SSL=false
# En producción, DB_SSL=true es OBLIGATORIO

# Pool de conexiones de base de datos
DB_POOL_MAX=8
DB_POOL_MIN=2
DB_POOL_IDLE=10000
DB_POOL_ACQUIRE=30000

# CONFIGURACIÓN JWT
# =================
JWT_SECRET=ZienShield2025_JWT_Secret_Key_Multi_Tenant_CHANGE_IN_PRODUCTION
JWT_EXPIRE=24h

# CONFIGURACIÓN WAZUH
# ===================
WAZUH_API_URL=https://194.164.172.92:55000
WAZUH_USERNAME=wazuh
WAZUH_PASSWORD=wazuh_secure_password_here
WAZUH_TIMEOUT=30000
WAZUH_RETRY_ATTEMPTS=3
WAZUH_RATE_LIMIT=4
WAZUH_SSL_VERIFY=false
# En producción, WAZUH_SSL_VERIFY=true es OBLIGATORIO

# CONFIGURACIÓN DE CACHÉ WAZUH
# ============================
WAZUH_CACHE_ENABLED=true
WAZUH_CACHE_MAX_MEMORY_MB=50
WAZUH_CACHE_MAX_ENTRIES=500
WAZUH_CACHE_CLEANUP_INTERVAL_MS=300000

# TTL del caché por tipo de datos (en milisegundos)
WAZUH_CACHE_TTL_HARDWARE=86400000   # 24 horas
WAZUH_CACHE_TTL_OS=43200000         # 12 horas  
WAZUH_CACHE_TTL_PACKAGES=21600000   # 6 horas
WAZUH_CACHE_TTL_NETWORK=1800000     # 30 minutos
WAZUH_CACHE_TTL_AGENTS=120000       # 2 minutos
WAZUH_CACHE_TTL_STATS=300000        # 5 minutos

# CONFIGURACIÓN CORS
# ==================
CORS_ORIGINS=http://localhost:3000,http://127.0.0.1:3000
# En producción: CORS_ORIGINS=https://tudominio.com,https://app.tudominio.com
CORS_CREDENTIALS=true
CORS_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOWED_HEADERS=Content-Type,Authorization,X-Requested-With

# URLs DEL FRONTEND
# =================
FRONTEND_URL=http://localhost:3000
SUPER_ADMIN_FRONTEND_URL=http://localhost:3000

# CONFIGURACIÓN DE RATE LIMITING
# ==============================
RATE_LIMIT_WINDOW_MS=900000        # 15 minutos
RATE_LIMIT_MAX_REQUESTS=100        # requests por ventana
RATE_LIMIT_AUTH_MAX=5              # requests de auth por ventana
RATE_LIMIT_MESSAGE=Demasiadas solicitudes desde esta IP

# CONFIGURACIÓN DE SEGURIDAD
# ==========================
HELMET_ENABLED=true
CORS_POLICY=cross-origin

# CONFIGURACIÓN DE LOGGING
# ========================
LOG_LEVEL=debug
# Opciones: error, warn, info, debug
LOG_CONSOLE_ENABLED=true
LOG_FILE_ENABLED=false
LOG_FILE_PATH=./logs
LOG_MAX_FILE_SIZE=10MB
LOG_MAX_FILES=5

# CONFIGURACIÓN DE MÉTRICAS
# =========================
METRICS_ENABLED=true
PROMETHEUS_ENABLED=true
METRICS_PATH=/metrics

# SERVICIO DE VULNERABILIDADES
# ============================
VULN_UPDATE_ENABLED=true
VULN_UPDATE_INTERVAL_MS=3600000    # 1 hora
VULN_BATCH_SIZE=50

# ====================================================================
# CONFIGURACIONES ESPECÍFICAS DE PRODUCCIÓN
# ====================================================================
# Descomenta y ajusta estas variables para producción:

# NODE_ENV=production

# # URLs de producción
# BASE_URL=https://api.tudominio.com
# FRONTEND_URL=https://tudominio.com
# SUPER_ADMIN_FRONTEND_URL=https://admin.tudominio.com

# # Base de datos de producción
# DB_HOST=prod-db-server.com
# DB_NAME=zienshield_prod
# DB_USER=zienshield_prod_user
# DB_PASSWORD=super_secure_production_password
# DB_SSL=true
# DB_POOL_MAX=15
# DB_POOL_MIN=5

# # Wazuh de producción
# WAZUH_API_URL=https://wazuh-prod.tudominio.com:55000
# WAZUH_USERNAME=api_prod_user
# WAZUH_PASSWORD=super_secure_wazuh_password
# WAZUH_SSL_VERIFY=true
# WAZUH_TIMEOUT=10000
# WAZUH_RATE_LIMIT=2

# # CORS de producción (MUY IMPORTANTE)
# CORS_ORIGINS=https://tudominio.com,https://admin.tudominio.com

# # Rate limiting más agresivo
# RATE_LIMIT_MAX_REQUESTS=50
# RATE_LIMIT_AUTH_MAX=3

# # JWT más seguro
# JWT_SECRET=production_jwt_secret_256_bits_minimum_length_required
# JWT_EXPIRE=1h

# # Logging de producción
# LOG_LEVEL=info
# LOG_FILE_ENABLED=true
# LOG_MAX_FILE_SIZE=50MB
# LOG_MAX_FILES=10

# ====================================================================
# CONFIGURACIONES ESPECÍFICAS DE TESTING
# ====================================================================
# Para entorno de testing, usa estas configuraciones:

# NODE_ENV=test
# PORT=3099
# DB_NAME=zienshield_test
# WAZUH_CACHE_ENABLED=false
# LOG_LEVEL=error
# LOG_CONSOLE_ENABLED=false
# LOG_FILE_ENABLED=false

# ====================================================================
# NOTAS IMPORTANTES
# ====================================================================
# 1. NUNCA commitear el archivo .env al repositorio
# 2. Usar JWT_SECRET de mínimo 32 caracteres en producción
# 3. Cambiar TODAS las contraseñas por defecto
# 4. Habilitar SSL (DB_SSL=true, WAZUH_SSL_VERIFY=true) en producción
# 5. Revisar y ajustar CORS_ORIGINS según tu dominio
# 6. Monitorear el uso de memoria del caché Wazuh
# 7. Ajustar rate limiting según tu tráfico esperado

# ====================================================================
# COMANDOS ÚTILES
# ====================================================================
# Validar configuración:
# node -e "console.log(require('./src/config/environment').getConfig())"
#
# Ver todas las variables cargadas:
# node -e "console.log(process.env)" | grep -E "(DB_|WAZUH_|JWT_|CORS_)"
#
# Testing de conectividad:
# curl http://localhost:3001/api/health