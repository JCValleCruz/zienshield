#!/bin/bash

echo "ğŸ“Š Importando Dashboard de ZienShield a Grafana"
echo "=============================================="
echo ""
echo "ğŸ”— Accede a Grafana: http://194.164.172.92:3002"
echo "ğŸ‘¤ Usuario: admin"
echo "ğŸ”‘ ContraseÃ±a: zienshield2024"
echo ""
echo "ğŸ“‹ Para importar el dashboard manualmente:"
echo "1. Ve a '+' (Create) > Import"
echo "2. Carga el archivo: monitoring/grafana/dashboards/zienshield-main-dashboard.json"
echo "3. Selecciona el datasource 'Prometheus'"
echo "4. Haz clic en 'Import'"
echo ""
echo "ğŸ“ˆ Dashboard incluye:"
echo "âœ… Usuarios Activos"
echo "âœ… Eventos de Seguridad por Segundo"
echo "âœ… Total de Empresas/Tenants"
echo "âœ… Agentes Conectados"
echo "âœ… CPU del Servidor"
echo "âœ… Memoria del Sistema"
echo "âœ… Requests HTTP por Segundo"
echo "âœ… DuraciÃ³n de Requests"
echo "âœ… Uso de Disco"
echo "âœ… Load Average"
echo ""
echo "ğŸ”„ ActualizaciÃ³n automÃ¡tica cada 30 segundos"
echo ""
echo "ğŸ’¡ ALTERNATIVA - Importar via API:"
echo "curl -X POST \\"
echo "  http://194.164.172.92:3002/api/dashboards/db \\"
echo "  -H 'Authorization: Basic YWRtaW46emllbnNoaWVsZDIwMjQ=' \\"
echo "  -H 'Content-Type: application/json' \\"
echo "  -d @monitoring/grafana/dashboards/zienshield-main-dashboard.json"
echo ""

# Verificar que las mÃ©tricas estÃ©n disponibles
echo "ğŸ” Verificando mÃ©tricas disponibles:"
echo -n "Prometheus: "
curl -s http://194.164.172.92:9090/api/v1/label/__name__/values | grep -c zienshield || echo "0"
echo -n "ZienShield Metrics: "
curl -s http://194.164.172.92:3001/metrics | grep -c "zienshield_" || echo "0"